@(user: User, profileForm: Form[Map[String, String]])(implicit flash: Flash, l: Lang)
@import helper._
@implicitField = @{ FieldConstructor(views.html.helpers.f) }

@main(Messages("user.profile.title"), user = Some(user), flash = flash) {
<div class="lightbg padtop padbottom shadow clearfix" style="z-index: 9;">
  <div class="constraint">
    <h1 class="nomargin left">
      @user.name (@user.username)
    </h1>
    <a href="@routes.BreakpointApplicationController.newApplication">
      <button class="submit_button pad right" style="width: 250px;">@Messages("applications.newApplication.new_application")</button>
    </a>
  </div>
</div>

<div class="whitebg padtop padbottom raiseshadow clearfix" style="z-index: 10;">
  <div class="constraint">
    <div class="left halfwidth">
      @helper.form(action = routes.UserController.updateProfile, 'id -> "user_form") {
        @helper.inputText(profileForm("name"), '_label -> Messages("common.full_name"))
        @helper.inputText(profileForm("email"), '_label -> Messages("common.email"), '_help -> "")
        @helper.inputPassword(profileForm("new_password"), '_label -> Messages("user.profile.new_password"), '_help -> "")
        @helper.inputPassword(profileForm("old_password"), '_label -> Messages("user.profile.old_password"), '_help -> "")
        <p class="disclaimer">
          @Messages("user.profile.password_change_note")
        </p>
        <button type="submit" class="submit_button pad">@Messages("common.save")</button>
      }
    </div>
    <div class="right halfwidth">
      <h3 class="nomargin">@Messages("common.secret_key")</h3>
      <code id="secret_key">@user.secretKey</code>
      <p style="font-size: small;">@Messages("user.profile.change_secret_key")</p>
      @helper.form(action = routes.UserController.changeSecretKey, 'id -> "change_secret_key_form") {
        <button type="submit"
                class="danger_button pad"
                onclick="return confirm('@Messages("user.profile.confirm_reset_secret_key")');">
          @Messages("user.profile.change_secret_key_link")
        </button>
      }
    </div>
  </div>
</div>
}
